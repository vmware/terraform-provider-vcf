---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "vcf_cluster Resource - terraform-provider-vcf"
subcategory: ""
description: |-

---

# vcf_cluster (Resource)

After you add the primary cluster, you can add more clusters to expand а domain.


The following data is prerequisite for creation:
* ID of the domain in which the cluster is to be created
* Cluster details
  * Name of the cluster
  * Hosts details:
    * ID of the host (UUID)
    * License key for the host
    * List of VDS names to associate with host
    * ID of the vmNic host to be associated with VDS, once added to cluster
  * Datastore details:
  **Note :** Only one of “vsan_datastore” (For VSAN), “nfs_datastores” (For NFS) or “vmfs_datastore” (For VMFS on FC) or "vvol_datastores" (For VVOL) or "vsan_remote_datastore_cluster" (For vSAN HCI Mesh Remote Datastore) must be specified.
  * Network Details
    * List of VDS details, For each VDS:
      * Port group names and the corresponding transport type. Note that EDGE_INFRA_OVERLAY_UPLINK, VREALIZE should not be specified in the input spec. Multiple port groups with transport type PUBLIC can be created.
      * DVS host Infrastructure traffic resource type
      * Maximum allowed usage for a traffic class
      * Amount of bandwidth to be reserved for the host infrastructure traffic class
    * NSX cluster Details, For NSX-T
      * VLAN ID of the Geneve
      * (**not yet supported**) IP address pool spec if the TEP IP assignment is done from IP pool For DHCP
    * Network pool must be configured.
  * Workload Domain must already exist. **Note:** NSX-T management cluster is configured when the domain is created.
  * Prerequisites for vSAN, NFS or VMFS on FC or VVOL must be met.
  * Host configuration must have minimum two active vmNics.
  * There must be at least three hosts available in the VMware Cloud Foundation inventory.
  * Ensure that the hosts you want to add to the cluster are in UNASSIGNED_USEABLE state.
  * You must have valid host and vSAN (if using vSAN storage) license key specified with adequate sockets available for the host to be added.
  * A DHCP server must be configured on the Geneve VLAN of the respective domains. When NSX-T creates VTEPs for the hosts in the domain, they are assigned IP addresses from the DHCP server.
  * Evaluate if you want to have pNICs on multiple vSphere Distributed Switches in the NSX-T domain. At least two pNICs are needed on a single switch.

**Note:** If you expand/contract a Cluster be sure to first remove the cluster ref under the cluster, apply the plan and then remove the commissioned host resource.
**Note:** Do not attempt to add and remove hosts in a single configuration change. Apply each change separately.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `host` (Block List, Min: 2) List of ESXi host information from the free pool to consume in a workload domain/ The minimum of 3 hosts is required for vSAN based clusters. For external storage, 2 host clusters are also supported. (see [below for nested schema](#nestedblock--host))
- `name` (String) Name of the cluster to add to the workload domain
- `vds` (Block List, Min: 1) vSphere Distributed Switches to add to the cluster (see [below for nested schema](#nestedblock--vds))

### Optional

- `cluster_image_id` (String) ID of the cluster image to be used with the cluster
- `domain_id` (String) The ID of a workload domain that the cluster belongs to. You cannot specify a value for `domain_name` if you set this attribute.
- `domain_name` (String) The name of a workload domain that the cluster belongs to. You cannot specify a value for `domain_id` if you set this attribute.
- `evc_mode` (String) EVC mode for new cluster, if needed. One among: INTEL_MEROM, INTEL_PENRYN, INTEL_NEALEM, INTEL_WESTMERE, INTEL_SANDYBRIDGE, INTEL_IVYBRIDGE, INTEL_HASWELL, INTEL_BROADWELL, INTEL_SKYLAKE, INTEL_CASCADELAKE, AMD_REV_E, AMD_REV_F, AMD_GREYHOUND_NO3DNOW, AMD_GREYHOUND, AMD_BULLDOZER, AMD_PILEDRIVER, AMD_STREAMROLLER, AMD_ZEN
- `geneve_vlan_id` (Number) VLAN ID use for NSX Geneve in the workload domain
- `high_availability_enabled` (Boolean) vSphere High Availability settings for the cluster
- `ip_address_pool` (Block List, Max: 1) Contains the parameters required to create or reuse an IP address pool. Omit for DHCP, provide name only to reuse existing IP Pool, if subnets are provided a new IP Pool will be created (see [below for nested schema](#nestedblock--ip_address_pool))
- `nfs_datastores` (Block List) Cluster storage configuration for NFS (see [below for nested schema](#nestedblock--nfs_datastores))
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))
- `vmfs_datastore` (Block List, Max: 1) Cluster storage configuration for VMFS (see [below for nested schema](#nestedblock--vmfs_datastore))
- `vsan_datastore` (Block List, Max: 1) Cluster storage configuration for vSAN (see [below for nested schema](#nestedblock--vsan_datastore))
- `vsan_remote_datastore_cluster` (Block List, Max: 1) Cluster storage configuration for vSAN Remote Datastore (see [below for nested schema](#nestedblock--vsan_remote_datastore_cluster))
- `vsan_stretch_configuration` (Block List, Max: 1) Settings for stretched vSAN clusters (see [below for nested schema](#nestedblock--vsan_stretch_configuration))
- `vvol_datastores` (Block List) Cluster storage configuration for VVOL (see [below for nested schema](#nestedblock--vvol_datastores))

### Read-Only

- `id` (String) ID of the cluster
- `is_default` (Boolean) Status of the cluster if default or not
- `is_stretched` (Boolean) Status of the cluster if stretched or not
- `primary_datastore_name` (String) Name of the primary datastore
- `primary_datastore_type` (String) Storage type of the primary datastore

<a id="nestedblock--host"></a>
### Nested Schema for `host`

Required:

- `id` (String) ID of the ESXi host in the free pool

Optional:

- `availability_zone_name` (String) Availability Zone Name. This is required while performing a stretched cluster expand operation
- `host_name` (String) Host name of the ESXi host
- `ip_address` (String) IPv4 address of the ESXi host
- `license_key` (String, Sensitive) License key for an ESXi host in the free pool. This is required except in cases where the ESXi host has already been licensed outside of the VMware Cloud Foundation system
- `password` (String, Sensitive) Password to authenticate to the ESXi host
- `serial_number` (String) Serial number of the ESXi host
- `ssh_thumbprint` (String, Sensitive) SSH thumbprint of the ESXi host
- `username` (String) Username to authenticate to the ESXi host
- `vmnic` (Block List) vmnic configuration for the ESXi host (see [below for nested schema](#nestedblock--host--vmnic))

<a id="nestedblock--host--vmnic"></a>
### Nested Schema for `host.vmnic`

Required:

- `id` (String) ESXI host vmnic ID to be associated with a VDS, once added to cluster

Optional:

- `uplink` (String) Uplink to be associated with vmnic
- `vds_name` (String) Name of the VDS to associate with the ESXi host



<a id="nestedblock--vds"></a>
### Nested Schema for `vds`

Required:

- `name` (String) vSphere Distributed Switch name

Optional:

- `is_used_by_nsx` (Boolean) Identifies if the vSphere distributed switch is used by NSX
- `nioc_bandwidth_allocations` (Block List) List of Network I/O Control Bandwidth Allocations for System Traffic based on shares, reservation, and limit, you can configure Network I/O Control to allocate certain amount of bandwidth for traffic generated by vSphere Fault Tolerance, iSCSI storage, vSphere vMotion, and so on. You can use Network I/O Control on a distributed switch to configure bandwidth allocation for the traffic  that is related to the main system features in vSphere (see [below for nested schema](#nestedblock--vds--nioc_bandwidth_allocations))
- `portgroup` (Block List) List of portgroups to be associated with the vSphere Distributed Switch (see [below for nested schema](#nestedblock--vds--portgroup))

<a id="nestedblock--vds--nioc_bandwidth_allocations"></a>
### Nested Schema for `vds.nioc_bandwidth_allocations`

Required:

- `type` (String) Host infrastructure traffic type. Example: management, faultTolerance, vmotion, virtualMachine, iSCSI, nfs, hbr, vsan, vdp etc.

Optional:

- `limit` (Number) The maximum allowed usage for a traffic class belonging to this resource pool per host physical NIC. The utilization of a traffic class will not exceed the specified limit even if there are available network resources. If this value is unset or set to -1 in an update operation, then there is no limit on the network resource usage (only bounded by available resource and shares). Units are in Mbits/sec
- `reservation` (Number) Amount of bandwidth resource that is guaranteed available to the host infrastructure traffic class. If the utilization is less than the reservation, the extra bandwidth is used for other host infrastructure traffic class types. Unit is Mbits/sec
- `shares` (Number) The number of shares allocated. Used to determine resource allocation in case of resource contention. This value is only set if level is set to custom. If level is not set to custom, this value is ignored. Therefore, only shares with custom values can be compared. There is no unit for this value. It is a relative measure based on the settings for other resource pools.
- `shares_level` (String) The allocation level. The level is a simplified view of shares. Levels map to a pre-determined set of numeric values for shares. If the shares value does not map to a predefined size, then the level is set as custom. One among: low, normal, high, custom


<a id="nestedblock--vds--portgroup"></a>
### Nested Schema for `vds.portgroup`

Required:

- `name` (String) Port group name
- `transport_type` (String) Port group transport type, One among: VSAN, VMOTION, MANAGEMENT, PUBLIC, NFS, VREALIZE, ISCSI, EDGE_INFRA_OVERLAY_UPLINK

Optional:

- `active_uplinks` (List of String) List of active uplinks associated with portgroup. This is only supported for VxRail.



<a id="nestedblock--ip_address_pool"></a>
### Nested Schema for `ip_address_pool`

Required:

- `name` (String) Providing only name of existing IP Address Pool reuses it, while providing a new name with subnets creates a new one

Optional:

- `description` (String) Description of the IP address pool
- `ignore_unavailable_nsx_cluster` (Boolean) Ignore unavailable NSX cluster(s) during IP pool spec validation
- `subnet` (Block List) List of IP address pool subnet specifications (see [below for nested schema](#nestedblock--ip_address_pool--subnet))

<a id="nestedblock--ip_address_pool--subnet"></a>
### Nested Schema for `ip_address_pool.subnet`

Required:

- `cidr` (String) The subnet representation, contains the network address and the prefix length
- `gateway` (String) The default gateway address of the network

Optional:

- `ip_address_pool_range` (Block List) List of the IP allocation ranges. At least 1 IP address range has to be specified (see [below for nested schema](#nestedblock--ip_address_pool--subnet--ip_address_pool_range))

<a id="nestedblock--ip_address_pool--subnet--ip_address_pool_range"></a>
### Nested Schema for `ip_address_pool.subnet.ip_address_pool_range`

Required:

- `end` (String) The last IP Address of the IP Address Range
- `start` (String) The first IP Address of the IP Address Range




<a id="nestedblock--nfs_datastores"></a>
### Nested Schema for `nfs_datastores`

Required:

- `datastore_name` (String) NFS datastore name used for cluster creation
- `path` (String) Shared directory path used for NFS based cluster creation
- `read_only` (Boolean) Readonly is used to identify whether to mount the directory as readOnly or not
- `server_name` (String) Fully qualified domain name or IP address of the NFS endpoint

Optional:

- `user_tag` (String) User tag used to annotate NFS share


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)


<a id="nestedblock--vmfs_datastore"></a>
### Nested Schema for `vmfs_datastore`

Required:

- `datastore_names` (List of String) VMFS datastore names used for VMFS on FC for cluster creation


<a id="nestedblock--vsan_datastore"></a>
### Nested Schema for `vsan_datastore`

Required:

- `datastore_name` (String) vSAN datastore name used for cluster creation

Optional:

- `dedup_and_compression_enabled` (Boolean) Enable vSAN deduplication and compression. Cannot be set when `esa_enabled` is `true`.
- `esa_enabled` (Boolean) Enable vSAN ESA. `dedup_and_compression_enabled` and `failures_to_tolerate` cannot be set when using this attribute.
- `failures_to_tolerate` (Number) Number of ESXi host failures to tolerate in the vSAN cluster. One of 0, 1, or 2. Cannot be set when `esa_enabled` is `true`.
- `license_key` (String, Sensitive) vSAN license key to be used


<a id="nestedblock--vsan_remote_datastore_cluster"></a>
### Nested Schema for `vsan_remote_datastore_cluster`

Required:

- `datastore_uuids` (List of String) vSAN HCI Mesh remote datastore UUIDs


<a id="nestedblock--vsan_stretch_configuration"></a>
### Nested Schema for `vsan_stretch_configuration`

Optional:

- `secondary_fd_host` (Block List) The list of hosts that will go into the secondary fault domain (see [below for nested schema](#nestedblock--vsan_stretch_configuration--secondary_fd_host))
- `witness_host` (Block List, Max: 1) Configuration for the witness host (see [below for nested schema](#nestedblock--vsan_stretch_configuration--witness_host))

<a id="nestedblock--vsan_stretch_configuration--secondary_fd_host"></a>
### Nested Schema for `vsan_stretch_configuration.secondary_fd_host`

Required:

- `id` (String) ID of the ESXi host in the free pool

Optional:

- `availability_zone_name` (String) Availability Zone Name. This is required while performing a stretched cluster expand operation
- `host_name` (String) Host name of the ESXi host
- `ip_address` (String) IPv4 address of the ESXi host
- `license_key` (String, Sensitive) License key for an ESXi host in the free pool. This is required except in cases where the ESXi host has already been licensed outside of the VMware Cloud Foundation system
- `password` (String, Sensitive) Password to authenticate to the ESXi host
- `serial_number` (String) Serial number of the ESXi host
- `ssh_thumbprint` (String, Sensitive) SSH thumbprint of the ESXi host
- `username` (String) Username to authenticate to the ESXi host
- `vmnic` (Block List) vmnic configuration for the ESXi host (see [below for nested schema](#nestedblock--vsan_stretch_configuration--secondary_fd_host--vmnic))

<a id="nestedblock--vsan_stretch_configuration--secondary_fd_host--vmnic"></a>
### Nested Schema for `vsan_stretch_configuration.secondary_fd_host.vmnic`

Required:

- `id` (String) ESXI host vmnic ID to be associated with a VDS, once added to cluster

Optional:

- `uplink` (String) Uplink to be associated with vmnic
- `vds_name` (String) Name of the VDS to associate with the ESXi host



<a id="nestedblock--vsan_stretch_configuration--witness_host"></a>
### Nested Schema for `vsan_stretch_configuration.witness_host`

Required:

- `fqdn` (String) Fully qualified domain name of the witness host. It should be routable on the vSAN network
- `vsan_cidr` (String) CIDR address for the witness host on the vSAN network
- `vsan_ip` (String) IP address for the witness host on the vSAN network



<a id="nestedblock--vvol_datastores"></a>
### Nested Schema for `vvol_datastores`

Required:

- `datastore_name` (String) vVol datastore name used for cluster creation
- `storage_container_id` (String) UUID of the VASA storage container
- `storage_protocol_type` (String) Type of the VASA storage protocol. One among: ISCSI, NFS, FC.
- `user_id` (String) UUID of the VASA storage user
- `vasa_provider_id` (String) UUID of the VASA storage provider
